function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},n={},s=e.parcelRequired7c6;null==s&&((s=function(t){if(t in i)return i[t].exports;if(t in n){var e=n[t];delete n[t];var s={id:t,exports:{}};return i[t]=s,e.call(s.exports,s,s.exports),s.exports}var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){n[t]=e},e.parcelRequired7c6=s),s.register("fExtF",(function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.default=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}})),s.register("iaRLo",(function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.default=function(t,e){return e.get?e.get.call(t):e.value}})),s.register("7K24o",(function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.default=function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}})),s.register("3LGG3",(function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.default=function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}}));var r={};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t,e){var i=o.default(t,e,"get");return l.default(t,i)};var o=a(s("fExtF")),l=a(s("iaRLo"));function a(t){return t&&t.__esModule?t:{default:t}}var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(t,e,i){h.default(t,e),e.set(t,i)};var u,h=(u=s("7K24o"))&&u.__esModule?u:{default:u};var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.default=function(t,e,i){var n=d.default(t,e,"set");return v.default(t,n,i),i};var d=f(s("fExtF")),v=f(s("3LGG3"));function f(t){return t&&t.__esModule?t:{default:t}}var g={};Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i};var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function(t,e){E.default(t,e),e.add(t)};var E=function(t){return t&&t.__esModule?t:{default:t}}(s("7K24o"));var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i;return t};class S{findLineElementUnderCoordinates(t,{x:e,y:i}){return document.elementsFromPoint(e,i).find((e=>e.className===t))}findElementWithLetter(t){const e=this.findLineElementUnderCoordinates(this.classNameTextLine,t);return"WORD"===e.nodeName?e:null}replaceSplitsCopyTextElement(t){if(!t)return!1;try{const e=Array.from(t.childNodes).filter((t=>t.nodeType==Node.TEXT_NODE&&t.nodeValue.match(/[a-zA-Z0-9]{2,}/)));if(0===e.length)return!1;e.forEach((t=>{const e=t.nodeValue.split(""),i=document.createDocumentFragment();e.forEach(((t,e)=>{const n=document.createElement("word");n.className=this.classNameTextLine,n.dataset.number=e,n.textContent=t,i.appendChild(n)})),this.replaceChild(i,t)}))}catch{return!1}return!0}replaceChild(t,e){e.parentNode.replaceChild(t,e)}getHitLetter(t,e,i){let n="";if(!t)return n;const s=Array.from(t.childNodes).filter((t=>t.nodeType==Node.TEXT_NODE&&t.nodeValue.match(/[a-zA-Z]{2,}/)));if(0===s.length)return n;const r=t.cloneNode(!0);s.forEach((t=>{const e=t.nodeValue.split(""),i=document.createDocumentFragment();e.forEach(((t,e)=>{const n=document.createElement("word");n.className=this.classNameTextLine,n.dataset.number=e,n.textContent=t,i.appendChild(n)})),this.replaceChild(i,t)}));const o=this.findLineElementUnderCoordinates(this.classNameTextLine,{x:e,y:i});return"WORD"===o.nodeName&&(n=o.textContent),this.replaceChild(r,t),n}constructor(t="text-line"){this.classNameTextLine=t}}var w=new WeakSet,T=new WeakSet,b=new WeakSet,y=new WeakSet;class C{clearStructure(){this.elementFrom=null,this.originalElementFrom=null,this.elementTo=null,this.originalElementTo=null,this.movingLetters=[],this.elementToMove=null}getTextMovingLetters(){return this.movingLetters.reduce(((t,e)=>t+e.textContent),"")}addElementToStructure(t){this.movingLetters.push(t)}deleteElementFromStructure(t){this.movingLetters=this.movingLetters.filter((e=>e!==t))}clearMovingLetters(){this.movingLetters=[]}addElementFrom(t){this.elementFrom=t,this.originalElementFrom=t.cloneNode(!0)}addElementTo(t){this.elementTo=t,this.originalElementTo=t.cloneNode(!0)}sortMovingLetters(){this.movingLetters.sort(((t,e)=>Number(t.dataset.number)-Number(e.dataset.number)))}countInMovingLetters(){return this.movingLetters.length}isElementInStructure(t){return this.movingLetters.find((e=>e===t))}isExistOriginalFromDocument(){return!!this.elementFrom&&!!this.originalElementFrom}isExistOriginalToDocument(){return!!this.elementTo&&!!this.originalElementTo}isMovingLettersNotEmpty(){return!!this.elementFrom&&this.movingLetters.length>0}isSavedElementFromEqualElementFrom(t){return this.elementFrom===t||this.elementFrom===t.parentNode}isElementToEqualElementFrom(t){return this.elementFrom===t||this.elementFrom===t.parentNode}isSavedElement(t){return!!this.elementFrom}isEmptyMovingLetters(){return 0===this.movingLetters.length}toMoveLetters(){this.elementToMove&&(this.isExistOriginalToDocument()?t(g)(this,w,L).call(this):t(g)(this,T,M).call(this))}constructor(){t(p)(this,w),t(p)(this,T),t(p)(this,b),t(p)(this,y),this.clearStructure()}}function L(){const e=this.originalElementTo.textContent,i=this.elementToMove.dataset.number,n=this.getTextMovingLetters();this.originalElementTo.textContent=e.substring(0,i)+n+e.substring(i);const s=t(g)(this,b,F).call(this),r=this.originalElementFrom.textContent;this.originalElementFrom.textContent=t(g)(this,y,R).call(this,r,s)}function M(){const e=this.originalElementFrom.textContent,i=this.elementToMove.dataset.number,n=this.getTextMovingLetters(),s=e.substring(0,i)+n+e.substring(i),r=t(g)(this,b,F).call(this,Number(i),Number(n.length));this.originalElementFrom.textContent=t(g)(this,y,R).call(this,s,r)}function F(t=0,e=0){const i=!this.isExistOriginalToDocument(),n=this.movingLetters.map((n=>{let s=Number(n.dataset.number);return i&&s>=t&&(s+=e),s}));return n.sort(((t,e)=>e-t)),n}function R(t,e){let i=t.split("");return e.forEach((t=>{i.splice(t,1)})),i.join("")}var k=new WeakSet;class W{constructor({classNameCanvas:e,elementOwner:i}={classNameCanvas:"canvas-field",elementOwner:null}){t(p)(this,k),t(x)(this,"resizeCanvas",(()=>{if(this.elementOwner){const t=this.elementOwner.getBoundingClientRect();this.canvasRef.width=t.width,this.canvasRef.height=t.height}else this.canvasRef.width=window.innerWidth,this.canvasRef.height=window.innerHeight})),t(x)(this,"listenerCanvas",(()=>{let t,e,i=!1;const n=this.canvasRef,s=n.getContext("2d"),r=()=>{i=!1,s.clearRect(0,0,n.width,n.height)};n.addEventListener("mousemove",(r=>{if(!i||!this.isAllowDrawing)return;const o=r.clientX-n.getBoundingClientRect().left,l=r.clientY-n.getBoundingClientRect().top,a=o-t,c=l-e;s.clearRect(0,0,n.width,n.height),s.beginPath(),s.strokeStyle="gray",s.rect(t,e,a,c),s.stroke()})),n.addEventListener("mousedown",(s=>{i=!0,t=s.clientX-n.getBoundingClientRect().left,e=s.clientY-n.getBoundingClientRect().top})),n.addEventListener("mouseup",r),n.addEventListener("mouseleave",r)})),this.canvasRef=document.querySelector(`.${e||"canvas-field"}`),this.elementOwner=i,t(g)(this,k,P).call(this),this.isAllowDrawing=!1}}function P(){window.addEventListener("resize",this.resizeCanvas),document.addEventListener("DOMContentLoaded",this.listenerCanvas)}class N{setStartPoint({x:t,y:e}){this.startPoint={x:t,y:e}}setCurrentPoint({x:t,y:e}){this.currentPoint={x:t,y:e}}clearRec(){this.startPoint={x:0,y:0},this.currentPoint={x:0,y:0}}isElementInRecSelection(t){return this.isCoordinateYInRec(t.top)||this.isCoordinateYInRec(t.bottom)||this.isStartSelectInElementOnAxisY(t)}isElementUnderRecSelection(t){return t.top>this.currentPoint.y&&t.bottom>this.currentPoint.y}isCoordinateYInRec(t){return this.startPoint.y<=t&&t<=this.currentPoint.y||this.currentPoint.y<=t&&t<=this.startPoint.y}isCoordinateXInRec(t){return this.startPoint.x<=t&&t<=this.currentPoint.x||this.currentPoint.x<=t&&t<=this.startPoint.x}isStartSelectInElementOnAxisY(t){return t.top<=this.startPoint.y&&this.startPoint.y<=t.bottom}oppositeVerticalAngle(){return{x:this.startPoint.x,y:this.currentPoint.y}}rightCoordinate(){return Math.max(this.startPoint.x,this.currentPoint.x)}leftCoordinate(){return Math.min(this.startPoint.x,this.currentPoint.x)}topCoordinate(){return Math.min(this.startPoint.y,this.currentPoint.y)}bottomCoordinate(){return Math.max(this.startPoint.y,this.currentPoint.y)}isElementInSelectedAxisX(t){return(this.leftCoordinate()<=t.left&&t.left<=this.rightCoordinate()||this.leftCoordinate()<=t.right&&t.right<=this.rightCoordinate())&&(this.topCoordinate()<=t.top&&t.top<=this.bottomCoordinate()||this.topCoordinate()<=t.bottom&&t.bottom<=this.bottomCoordinate())}isElementInSelectedAxisY(t){return!0}isElementInAnotherLine(t,e){return e.bottom<t.top||e.top>t.bottom}constructor(){this.clearRec()}}var D=new WeakMap,O=new WeakMap,I=new WeakMap,q=new WeakMap,A=new WeakMap,j=new WeakSet,Y=new WeakSet,B=new WeakSet,U=new WeakSet,V=new WeakSet,X=new WeakSet,$=new WeakSet,z=new WeakMap,G=new WeakSet,K=new WeakSet,H=new WeakSet,Z=new WeakSet,J=new WeakSet,Q=new WeakSet,tt=new WeakMap,et=new WeakMap,it=new WeakMap,nt=new WeakSet,st=new WeakSet,rt=new WeakSet,ot=new WeakSet,lt=new WeakSet,at=new WeakSet,ct=new WeakSet,ut=new WeakMap,ht=new WeakMap,mt=new WeakMap,dt=new WeakMap,vt=new WeakMap;function ft(){document.addEventListener("mousedown",t(r)(this,ut)),document.addEventListener("mouseup",t(r)(this,ht)),document.addEventListener("keyup",t(r)(this,vt))}function gt(){this.movingStructure.isExistOriginalFromDocument()&&this.nodeFunction.replaceChild(this.movingStructure.originalElementFrom,this.movingStructure.elementFrom),this.movingStructure.isExistOriginalToDocument()&&this.nodeFunction.replaceChild(this.movingStructure.originalElementTo,this.movingStructure.elementTo)}function pt(){t(g)(this,Y,gt).call(this),this.movingStructure.clearStructure()}function Et(t){const e=this.nodeFunction.findLineElementUnderCoordinates(this.classNameTextLine,t);return!!e&&!!this.movingStructure.isElementInStructure(e)}function xt(e){const i=this.nodeFunction.findLineElementUnderCoordinates(this.classNameTextLine,e);if(!i)return;if(!this.movingStructure.isElementToEqualElementFrom(i)&&(this.movingStructure.addElementTo(i),!this.nodeFunction.replaceSplitsCopyTextElement(i)))return t(g)(this,B,pt).call(this),!1;const n=this.nodeFunction.findElementWithLetter(e);if(!n||!n.textContent)return!1;this.movingStructure.elementToMove=n}function St(e){const i=this.nodeFunction.findLineElementUnderCoordinates(this.classNameTextLine,e);if(!i||this.movingStructure.isMovingLettersNotEmpty()&&!this.movingStructure.isSavedElementFromEqualElementFrom(i))return!1;if(!(this.movingStructure.isSavedElement()&&this.movingStructure.isSavedElementFromEqualElementFrom(i)||(this.movingStructure.addElementFrom(i),this.nodeFunction.replaceSplitsCopyTextElement(i))))return t(g)(this,B,pt).call(this),!1;const n=this.nodeFunction.findElementWithLetter(e);return n&&n.textContent?(this.movingStructure.isElementInStructure(n)?(this.movingStructure.deleteElementFromStructure(n),n.dataset.selection=!1):(this.movingStructure.addElementToStructure(n),n.dataset.selection=!0),this.movingStructure.isMovingLettersNotEmpty()):(t(g)(this,B,pt).call(this),!1)}function wt(e){t(g)(this,V,xt).call(this,e),this.movingStructure.toMoveLetters()}function Tt(){const e=this.textsDocumentRef.querySelectorAll(`.${this.classNameTextLine}`);if(0===e.length)return;let i=null;for(const n of e){const e=n.getBoundingClientRect();if(this.recSelection.isElementInRecSelection(e)&&t(g)(this,K,bt).call(this,n)){i=n;break}if(this.recSelection.isElementUnderRecSelection(e))break}i&&this.movingStructure.addElementFrom(i)}function bt(e){this.movingStructure.addElementFrom(e),this.nodeFunction.replaceSplitsCopyTextElement(e);return 0!==t(g)(this,H,yt).call(this,!0).length||(t(g)(this,B,pt).call(this),!1)}function yt(t=!1){const e=this.movingStructure.elementFrom.children,i=this.recSelection.leftCoordinate(),n=this.recSelection.rightCoordinate(),s=[];for(const r of e){const e=r.getBoundingClientRect();if(!(e.right<i)&&(!(e.left>n)&&this.recSelection.isElementInSelectedAxisX(e)&&this.recSelection.isElementInSelectedAxisY(e)&&(s.push(r),t)))break}return s}function Ct(){const e=t(g)(this,H,yt).call(this);if(0===e.length)return this.movingStructure.clearMovingLetters(),void t(g)(this,Q,Mt).call(this);t(g)(this,J,Lt).call(this,e),t(g)(this,Q,Mt).call(this)}function Lt(t){const e=this.movingStructure.movingLetters;for(let i=e.length-1;i>=0;i--){const n=t.findIndex((t=>t===e[i]));-1===n?(e[i].dataset.selection=!1,e.splice(i,1)):t.splice(n,1)}if(t.length>0){const i=e.length>0?e[0].getBoundingClientRect():t[0].getBoundingClientRect();for(const e of t)i&&this.recSelection.isElementInAnotherLine(i,e.getBoundingClientRect())||(this.movingStructure.addElementToStructure(e),e.dataset.selection=!0)}this.movingStructure.sortMovingLetters()}function Mt(){const t=this.textsDocumentRef.querySelectorAll(`.${this.classNameTextLine}[data-selection = "true"]`);for(const e of t)this.movingStructure.isElementInStructure(e)||(e.dataset.selection=!1)}function Ft(e){return t(r)(this,O)===e}function _t(e){t(m)(this,O,t(r)(this,D).selected_rec),this.canvas.isAllowDrawing=!0,this.recSelection.setStartPoint(e),document.addEventListener("mousemove",t(r)(this,dt)),document.removeEventListener("mousemove",t(r)(this,mt))}function Rt(){t(m)(this,O,t(r)(this,D).selected_letter),document.addEventListener("mousemove",t(r)(this,mt))}function kt(){t(m)(this,O,t(r)(this,D).moving_letter)}function Wt(){t(m)(this,O,t(r)(this,D).ready)}function Pt(){t(m)(this,O,t(r)(this,D).wait_moving_rec)}function Nt(){t(r)(this,et).call(this),this.recSelection.clearRec(),this.canvas.isAllowDrawing=!1}var Dt=new WeakSet,Ot=new WeakSet;function It(){this.textForm.addEventListener("submit",t(g)(this,Ot,qt).bind(this))}function qt(t){const e=t.target;t.preventDefault(),this.addText(e.elements.text.value.trim()),e.reset()}const At=new class{constructor(e="texts-document",i="text-line",n="moving-test"){t(p)(this,j),t(p)(this,Y),t(p)(this,B),t(p)(this,U),t(p)(this,V),t(p)(this,X),t(p)(this,$),t(p)(this,G),t(p)(this,K),t(p)(this,H),t(p)(this,Z),t(p)(this,J),t(p)(this,Q),t(p)(this,nt),t(p)(this,st),t(p)(this,rt),t(p)(this,ot),t(p)(this,lt),t(p)(this,at),t(p)(this,ct),t(c)(this,D,{writable:!0,value:{ready:"READY",selected_rec:"SELECTED_REC",moving_letter:"MOVING_LETTER",selected_letter:"SELECTED_LETTED",wait_moving_rec:"WAIT_MOVING_REC"}}),t(c)(this,O,{writable:!0,value:t(r)(this,D).ready}),t(c)(this,I,{writable:!0,value:!1}),t(c)(this,q,{writable:!0,value:!1}),t(c)(this,A,{writable:!0,value:!1}),t(x)(this,"addText",(t=>{const e=`<p class="${this.classNameTextLine}" >${t}</p>`;this.textsDocumentRef.insertAdjacentHTML("beforeend",e)})),t(c)(this,z,{writable:!0,value:e=>{this.recSelection.setCurrentPoint({x:e.clientX,y:e.clientY});const i=this.movingStructure.elementFrom;i&&!this.recSelection.isElementInRecSelection(i.getBoundingClientRect())&&(t(g)(this,B,pt).call(this),t(g)(this,Q,Mt).call(this)),this.movingStructure.isExistOriginalFromDocument()||t(g)(this,G,Tt).call(this),this.movingStructure.isExistOriginalFromDocument()&&t(g)(this,Z,Ct).call(this)}}),t(c)(this,tt,{writable:!0,value:()=>{this.movingTextsDocumentRef.style.display="block",this.movingTextsDocumentRef.textContent=this.movingStructure.getTextMovingLetters(),t(m)(this,A,!0)}}),t(c)(this,et,{writable:!0,value:()=>{this.movingTextsDocumentRef.style.display="none",t(m)(this,A,!1)}}),t(c)(this,it,{writable:!0,value:t=>{this.movingTextsDocumentRef.style.left=t.x+"px",this.movingTextsDocumentRef.style.top=t.y+5+"px"}}),t(c)(this,ut,{writable:!0,value:e=>{t(m)(this,q,!0),t(m)(this,I,e.ctrlKey);const i={x:e.clientX,y:e.clientY};t(g)(this,nt,Ft).call(this,t(r)(this,D).wait_moving_rec)?t(g)(this,U,Et).call(this,i)?(t(g)(this,ot,kt).call(this),document.addEventListener("mousemove",t(r)(this,mt))):t(g)(this,B,pt).call(this):t(g)(this,X,St).call(this,i)?t(g)(this,rt,Rt).call(this):t(g)(this,st,_t).call(this,i)}}),t(c)(this,ht,{writable:!0,value:e=>{t(m)(this,q,!1),t(g)(this,ct,Nt).call(this);const i={x:e.clientX,y:e.clientY};document.removeEventListener("mousemove",t(r)(this,mt)),document.removeEventListener("mousemove",t(r)(this,dt)),t(r)(this,I)||(t(g)(this,nt,Ft).call(this,t(r)(this,D).moving_letter)&&t(g)(this,$,wt).call(this,i),t(g)(this,nt,Ft).call(this,t(r)(this,D).selected_rec)&&!this.movingStructure.isEmptyMovingLetters()?t(g)(this,at,Pt).call(this):(t(g)(this,B,pt).call(this),t(g)(this,lt,Wt).call(this)))}}),t(c)(this,mt,{writable:!0,value:e=>{(t(g)(this,nt,Ft).call(this,t(r)(this,D).selected_letter)||t(g)(this,nt,Ft).call(this,t(r)(this,D).moving_letter))&&(t(g)(this,ot,kt).call(this),t(r)(this,A)||t(r)(this,tt).call(this),t(r)(this,it).call(this,{x:e.clientX,y:e.clientY}))}}),t(c)(this,dt,{writable:!0,value:_.throttle(t(r)(this,z),100,{trailing:!0})}),t(c)(this,vt,{writable:!0,value:e=>{"Control"===e.key&&(t(m)(this,I,!1),t(r)(this,q)||t(g)(this,B,pt).call(this))}}),this.classNameTextLine=i,this.textsDocumentRef=document.querySelector(`.${e}`),this.movingTextsDocumentRef=document.querySelector(`.${n}`),this.nodeFunction=new S(i),this.movingStructure=new C,this.recSelection=new N,this.canvas=new W({elementOwner:this.textsDocumentRef}),this.canvas.resizeCanvas(),t(g)(this,j,ft).call(this)}};new class{constructor(e,i="text-form"){t(p)(this,Dt),t(p)(this,Ot),this.textForm=document.querySelector(`.${i}`),this.addText=e,t(g)(this,Dt,It).call(this)}}(At.addText),At.addText("Lorem ipsum dolor sit amet, consectetur adipiscing elit. "),At.addText("Integer euismod, sapien ac sodales consectetur, metus tellus consequat nisl, "),At.addText("nec dignissim enim odio vel metus. Sed sed tellus nec elit sagittis tempus. Mauris nec commodo ipsum."),At.addText("Vivamus auctor fringilla sapien, eu tincidunt lacus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Ut dignissim, velit vel consequat fermentum, libero risus venenatis quam, eu fermentum velit nulla non magna."),At.addText("Duis convallis pretium erat, sit amet luctus mauris mattis eu. Proin auctor orci quis felis pulvinar, ac eleifend sapien posuere. Integer at libero libero."),At.addText("Sed nec dapibus leo. Nulla facilisi. Vestibulum et erat vel nisi maximus malesuada. Mauris vestibulum odio ac nunc volutpat, ac malesuada sapien vestibulum. Proin quis risus ut magna accumsan malesuada."),At.addText("Cras ullamcorper nisi eu sem laoreet, vel suscipit est consequat. Sed nec luctus ipsum. Suspendisse sit amet libero vel arcu rutrum scelerisque. Vivamus convallis semper justo, id ultricies velit fringilla a."),At.addText("Phasellus vel ultrices eros. In vitae justo quis felis consectetur convallis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.");
//# sourceMappingURL=index.3cfdeed9.js.map
